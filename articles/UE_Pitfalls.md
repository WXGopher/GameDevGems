### Pitfalls in UE4

Here is a collection of random pitfalls (~~they are feature not bugs~~) I've encountered. 

//TOC here

#### On DDC cache /UE4.27

UE uses DDC to cache cooked data and facilitates user operations. See [Derived Data Cache](https://docs.unrealengine.com/4.26/en-US/ProductionPipelines/DerivedDataCache/). A caveat here is **anyone** is able to create and upload DDC data (in case of a shared, e.g., networked, DDC).

Take physics mesh for example. Collision data is loaded in `getPhysicsTriMeshData`. This process includes trying to retrieve DDC cooked data in `GetDDCBuiltData` based on a cache key:

```c++
	/** 
	 * Static function to build a cache key out of the plugin name, versions and plugin specific info
	 * @param PluginName						Name of the derived data type
	 * @param VersionString						Version string of the derived data
	 * @param PluginSpecificCacheKeySuffix		GUIDS and / or Hashes, etc to uniquely identify the specific cache entry
	 * @return									Assembled cache key
	**/
	static FString BuildCacheKey(const TCHAR* PluginName, const TCHAR* VersionString, const TCHAR* PluginSpecificCacheKeySuffix)
	{
		return BuildCacheKey(FStringView(PluginName), FStringView(VersionString), FStringView(PluginSpecificCacheKeySuffix));
	}
```

Different types of data have different ways of creating their cache keys. For triangle-face based physics collision, mesh info is encoded into the DDC cache key:

```c++
	IInterface_CollisionDataProvider* CDP = Cast<IInterface_CollisionDataProvider>(GetOuter());
	if(CDP)
	{
		CDP->GetMeshId(MeshIdString);
	}
```

For spline mesh, deformation info is also encoded, see `USplineMeshComponent::GetMeshId`.

**Collision is never cooked if an asset with the same DDC key is retrieved from the DDC**

For example, if you changed the way collision mesh is generated by removing/adding vertices/faces, and such removal/addition is not encoded somehow in the DDC key, the newly cooked collision mesh might not shared with other teammates unless you manually cleaned the DDC.

Another case is if your revision to the engine is not synced immediately to other teammates, old collision mesh generated by older version engine is still kept in the DDC and other teammates will not get newly cooked data from new engines.

Rule of thumb: be aware of encoding change to assets in a DDC key. For debugging DDC related issue, unplug your network cable beforehand.